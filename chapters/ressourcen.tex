\chapter{Ressourcenverwaltung}

\section{Resource Quotas und LimitRanges}
Ermöglicht es, Ressourcenlimits und -quoten für Namespaces festzulegen. Resource Quotas begrenzen die Gesamtmenge an Ressourcen, die von einem Namespace verbraucht werden können, während LimitRanges Mindest- und Höchstwerte für die Ressourcen festlegen, die einzelne Container oder Pods verwenden können.\\

\noindent
\begin{tabular}{
|p{0.7\textwidth}|p{0.3\textwidth}|}
\hline
\textbf{Befehl} & \textbf{Beschreibung} \\
\hline
\texttt{kubectl get resourcequotas} & ResourceQuotas auflisten \\
\texttt{kubectl describe resourcequota <resourcequota-name>} & Details anzeigen \\
\texttt{kubectl delete resourcequota <resourcequota-name>} & ResourceQuota löschen \\
\texttt{kubectl get limitranges} & LimitRanges auflisten \\
\texttt{kubectl create -f <resourcequota.yaml>} & Resource Quota erstellen\\
\texttt{kubectl create -f <limitrange.yaml>} & LimitRange erstellen\\
\texttt{kubectl apply -f <resourcequota.yaml>} & Resource Quota updaten\\
\texttt{kubectl apply -f <limitrage.yaml>} & LimitRange updaten\\
\texttt{kubectl describe limitrange <limitrange-name>} & Details anzeigen \\
\texttt{kubectl delete limitrange <limitrange-name>} & LimitRange löschen \\
\hline
\end{tabular}

\subsubsection{YAML-Datei für eine ResourceQuota}
\input{minted/tex/YAML-resource-quota.tex}

\newpage
\subsubsection{YAML-Datei für eine LimitRange}
\input{minted/tex/YAML-limitrange.tex}

\subsection{Anwendungsfälle für Resource Quotas und LimitRanges}
\begin{itemize}
    \item Sicherstellen, dass ein Namespace nicht mehr Ressourcen als vorgesehen verbraucht.
    \item Verhindern, dass einzelne Pods oder Container zu viele Ressourcen beanspruchen.
    \item Ermöglichen einer fairen Ressourcenverteilung zwischen verschiedenen Teams oder Projekten.
    \item Schutz des Clusters vor Ressourcenengpässen durch übermäßige Nutzung.
\end{itemize}

\subsection{Best Practices für Resource Quotas und LimitRanges}
\begin{itemize}
    \item Realistische Quoten und Limits basierend auf der tatsächlichen Nutzung und den Anforderungen der Anwendungen setzen.
    \item Regelmäßig die Ressourcennutzung überwachen, um sicherzustellen, dass die Quoten und Limits angemessen sind.
    \item Die Quoten und Limits klar an alle Teams kommunizieren, um Verständnis und Akzeptanz zu fördern.
    \item Namespaces nutzen, um verschiedene Quoten und Limits für unterschiedliche Teams oder Projekte festzulegen.
    \item Die Quoten und Limits bei Änderungen der Anforderungen oder der Clusterkapazität anpassen.
\end{itemize}

\subsection{Weitere nützliche Befehle für Resource Quotas und LimitRanges}
\begin{tabular}{|p{0.7\textwidth}|p{0.3\textwidth}|}
\hline
\textbf{Befehl} & \textbf{Beschreibung} \\
\hline
\texttt{kubectl get resourcequotas -o yaml} & Konfiguration anzeigen \\
\texttt{kubectl get limitranges -o yaml} & Konfiguration anzeigen \\
\texttt{kubectl patch resourcequota <resourcequota-name> -p <patch-data>} & Patch anwenden \\
\texttt{kubectl patch limitrange <limitrange-name> -p <patch-data>} & Patch anwenden \\
\texttt{kubectl edit resourcequota <resourcequota-name>} & ResourceQuota bearbeiten \\
\texttt{kubectl edit limitrange <limitrange-name>} & LimitRange bearbeiten \\
\texttt{kubectl get pods {-}{-}namespace=<namespace> {-}{-}field-selector=status.phase=Failed} & Fehlgeschlagene Pods auflisten\\
\hline
\end{tabular}

\subsection*{Nützliche Links und Ressourcen}
Kubernetes Resource Quotas Dokumentation:\\
\url{https://kubernetes.io/docs/concepts/policy/resource-quotas/}\\
Kubernetes Task: Administering Resource Quotas:\\
\url{https://kubernetes.io/docs/tasks/administer-cluster/quota-api-object/}\\
Kubernetes Limit Range Dokumentation:\\
\url{https://kubernetes.io/docs/concepts/policy/limit-range/}\\
Kubernetes Task: Managing Compute Resources for Containers:\\
{\normalsize\ttfamily\href{https://kubernetes.io/docs/tasks/administer-cluster/manage-resources/memory-default-namespace/}{https://kubernetes.io/docs/tasks/administer-cluster/manage-resources/memory-default-namespace/}}




\section{PodDisruptionBudgets (PDB)}
PodDisruptionBudgets (PDB) werden verwendet, um die Anzahl der gleichzeitigen Pod-Ausfälle zu begrenzen. Sie helfen dabei, die Verfügbarkeit von Anwendungen zu gewährleisten, indem sie sicherstellen, dass eine Mindestanzahl von Pods immer verfügbar bleibt, selbst während Wartungsarbeiten oder Upgrades.\\

\noindent
\begin{tabular}{
|p{0.4\textwidth}|p{0.6\textwidth}|}
\hline
\textbf{Befehl} & \textbf{Beschreibung} \\
\hline
\texttt{kubectl get pdb} & PodDisruptionBudgets auflisten \\
\texttt{kubectl describe pdb <pdb-name>} & Details anzeigen \\
\texttt{kubectl create -f <pdb.yaml>} & PodDisruptionBudget erstellen\\
\texttt{kubectl apply -f <pdb.yaml>} & PodDisruptionBudget updaten\\
\texttt{kubectl delete pdb <pdb-name>} & PodDisruptionBudget löschen \\
\hline
\end{tabular}

\subsubsection{Beispielkonfiguration für ein PodDisruptionBudget}
\input{minted/tex/YAML-pdb.tex}

\newpage

\subsection{Anwendungsfälle für PodDisruptionBudgets}
\begin{itemize}
    \item Sicherstellen, dass eine Mindestanzahl von Pods während geplanter Wartungsarbeiten verfügbar bleibt.
    \item Schutz kritischer Anwendungen vor zu vielen gleichzeitigen Pod-Ausfällen.
    \item Verbesserung der Anwendungsverfügbarkeit während automatisierter Upgrades und Rollouts.
    \item Unterstützung bei der Einhaltung von Service Level Agreements (SLAs) durch Gewährleistung der Verfügbarkeit.
\end{itemize}

\subsection{Best Practices für PodDisruptionBudgets}
\begin{itemize}
    \item Realistische Werte für \texttt{minAvailable} oder \texttt{maxUnavailable} setzen, um die Verfügbarkeit von Anwendungen zu gewährleisten.
    \item Überprüfe regelmäßig die Konfiguration der PDBs, um sicherzustellen, dass sie den aktuellen Anforderungen entsprechen.
    \item PDBs mit anderen Hochverfügbarkeitsstrategien wie ReplicaSets und Deployments kombinieren.
    \item Alle PDBs und deren Zweck dokumentieren, um die Verwaltung zu erleichtern.
    \item Die Auswirkungen von PDBs in einer Staging-Umgebung testen, bevor sie in der Produktion verwendet werden.
\end{itemize}

\subsection{Weitere nützliche Befehle für PodDisruptionBudgets}
\begin{tabular}{|p{0.53\textwidth}|p{0.47\textwidth}|}
\hline
\textbf{Befehl} & \textbf{Beschreibung} \\
\hline
\texttt{kubectl get pdb -o yaml} & Konfiguration anzeigen \\
\texttt{kubectl edit pdb <pdb-name>} & PodDisruptionBudget bearbeiten \\
\texttt{kubectl patch pdb <pdb-name> -p <patch-data>} & Patch anwenden \\
\texttt{kubectl get pods {-}{-}selector=<label-selector>} & Von PDB betroffene Pods auflisten \\
\hline
\end{tabular}

\subsection*{Nützliche Links und Ressourcen}
Kubernetes PodDisruptionBudgets Dokumentation:\\
\url{https://kubernetes.io/docs/concepts/workloads/pods/disruptions/}\\
Kubernetes Task: Configure PodDisruptionBudget:\\
\url{https://kubernetes.io/docs/tasks/run-application/configure-pdb/}
